<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="css/tailwind.css" />
    <title>Students</title>
  </head>
  <body class="bg-gray-200">
    <header class="body-font bg-white text-gray-400">
      <div
        class="container mx-auto flex flex-col flex-wrap items-center p-5 md:flex-row"
      >
        <nav
          class="flex flex-wrap items-center justify-center text-base md:ml-auto md:mr-auto"
        >
          <a
            href="students.html"
            class="mr-5 font-medium text-black underline hover:text-black"
            >Students</a
          >
          <a href="courses.html" class="mr-5 text-gray-600 hover:text-black"
            >Courses</a
          >
          <a href="grades.html" class="mr-5 text-gray-600 hover:text-black"
            >Grades</a
          >
          <a href="results.html" class="mr-5 text-gray-600 hover:text-black"
            >Results</a
          >
        </nav>
      </div>
    </header>
    <div class="mx-auto flex w-3/4 flex-col items-center justify-center">
      <div class="my-5 flex w-full justify-end">
        <a href="add-student.html" class="primary-button">Add Student</a>
      </div>
      <div
        class="container mx-auto max-h-[80%] min-h-[60%] w-full overflow-y-auto rounded-md bg-white p-10 sm:p-4"
      >
        <h2 class="mb-3 text-2xl font-semibold leading-tight">All Students</h2>
        <div class="overflow-x-auto">
          <table class="min-w-full text-xs">
            <thead class="rounded-t-lg">
              <tr class="">
                <th title="Ranking" class="p-3 text-left">Sr. No</th>
                <th title="Team name" class="p-3 text-left">First Name</th>
                <th title="Wins" class="p-3 text-left">Last Name</th>
                <th title="Losses" class="p-3 text-left">Roll No.</th>
                <th title="Win percentage" class="p-3 text-left">Email</th>
                <th title="Games behind" class="p-3 text-left">Phone No.</th>
                <th title="Current streak" class="p-3 text-center" colspan="2">
                  Action
                </th>
              </tr>
            </thead>
            <tbody id="tableBody"></tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="absolute right-2 top-2 hidden" id="deleteNotification">
      <div
        class="flex max-w-lg items-center justify-between space-x-4 rounded-lg border-l-8 border-red-500 bg-white p-6 text-black sm:py-5"
      >
        <span>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="h-6 w-6"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
            />
          </svg>
        </span>
        <span> Deleted successfully! </span>
      </div>
    </div>
    <div class="absolute right-2 top-2 hidden" id="editedNotification">
      <div
        class="flex max-w-lg items-center justify-between space-x-4 rounded-lg border-l-8 border-green-500 bg-white p-6 text-black sm:py-5"
      >
        <span>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="h-6 w-6"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
            />
          </svg>
        </span>
        <span> Updated successfully! </span>
      </div>
    </div>
    <div class="absolute top-0 z-10 hidden w-full" id="formContainer">
      <div class="flex w-full items-center justify-center bg-gray-600/50">
        <div
          class="flex-cols relative m-4 flex h-full max-w-4xl flex-col items-center justify-center space-y-10 rounded-lg bg-white p-5 sm:m-10 sm:h-3/4 sm:p-20"
        >
          <h1 class="my-2 py-4 text-center text-3xl font-bold">Edit student</h1>
          <form action="#" class="w-full" method="POST">
            <div class="flex w-full space-x-10">
              <div class="flex flex-col">
                <input type="hidden" name="id" />
                <label class="block py-0.5 px-0.5 text-sm">First Name</label>
                <input
                  required
                  type="text"
                  name="firstName"
                  placeholder="First Name"
                  class="form-input"
                />
              </div>
              <div class="flex flex-col">
                <label class="block py-0.5 px-0.5 text-sm">Last Name</label>
                <input
                  required
                  type="text"
                  name="lastName"
                  placeholder="Last Name"
                  class="form-input"
                />
              </div>
            </div>
            <div class="mt-4 flex w-full space-x-10">
              <div class="flex flex-col">
                <label class="block py-0.5 px-0.5 text-sm">Roll No.</label>
                <input
                  required
                  type="text"
                  name="rollNo"
                  placeholder="Roll No."
                  class="form-input"
                />
              </div>
              <div class="flex flex-col">
                <label class="block py-0.5 px-0.5 text-sm">Phone No.</label>
                <input
                  required
                  name="phoneNo"
                  type="text"
                  placeholder="Phone No."
                  class="form-input"
                />
              </div>
            </div>
            <div class="mt-4 flex w-full space-x-10">
              <div class="flex flex-col">
                <label class="block py-0.5 px-0.5 text-sm">Email</label>
                <input
                  required
                  name="email"
                  type="text"
                  placeholder="Email"
                  class="form-input"
                />
              </div>
            </div>
            <div class="mt-10 flex w-full justify-end space-x-3">
              <button type="button" class="secondary-button" id="cancelButton">
                Cancel
              </button>
              <button
                type="submit"
                class="rounded-md bg-green-600 px-5 py-2.5 text-white"
                id="editStudentSubmitButton"
              >
                Edit Student
              </button>
            </div>
          </form>

          <div
            class="absolute -top-8 right-2 cursor-pointer"
            id="closeModalButton"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="h-6 w-6"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
              />
            </svg>
          </div>
        </div>
      </div>
    </div>
    
    <script>
      // window.onload = () => {
      //   const data = getDataFromStorage("students");
      //   let tableData;

      //   if (!data || !data.length) {
      //     tableData = `<tr rowspan="3" class="h-40"><td colspan="7" class="text-2xl text-center">No Data Found in Database!</td></tr>`;
      //   } else {
      //     tableData = data
      //       .map((student, index) => {
      //         id = student.id;
      //         return `<tr class="border-b border-opacity-20">
      //            <td class="px-3 py-2 text-left">
      //              <span>${index + 1}</span>
      //            </td>
      //            <td class="px-3 py-2 text-left">
      //              <span> ${student.firstName} </span>
      //            </td>
      //            <td class="px-3 py-2">
      //              <span>${student.lastName}</span>
      //            </td>
      //            <td class="px-3 py-2">
      //              <span>${student.rollNo}</span>
      //            </td>
      //            <td class="px-3 py-2">
      //              <span>${student.email}</span>
      //            </td>
      //            <td class="px-3 py-2">
      //              <span>${student.phoneNo}</span>
      //            </td>
      //            <td class="px-1 py-2 hover:cursor-pointer editButton" title="Edit">
      //              <span>
      //                <svg
      //                  xmlns="http://www.w3.org/2000/svg"
      //                  fill="none"
      //                  viewBox="0 0 24 24"
      //                  stroke-width="1.5"
      //                  stroke="currentColor"
      //                  class="h-6 w-6"
      //                >
      //                  <path
      //                    stroke-linecap="round"
      //                    stroke-linejoin="round"
      //                    d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"
      //                  />
      //                </svg>
      //              </span>
      //            </td>
      //            <td class="px-1 py-2 hover:cursor-pointer hover:text-red-500 deleteButton" title="Delete">
      //              <span
      //                ><svg
      //                  xmlns="http://www.w3.org/2000/svg"
      //                  fill="none"
      //                  viewBox="0 0 24 24"
      //                  stroke-width="1.5"
      //                  stroke="currentColor"
      //                  class="h-6 w-6"
      //                >
      //                  <path
      //                    stroke-linecap="round"
      //                    stroke-linejoin="round"
      //                    d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"
      //                  />
      //                </svg>
      //              </span>
      //            </td>
      //          </tr>`;
      //       })
      //       .join("");
      //   }

      //   const tableBody = document.querySelector("#tableBody");
      //   tableBody.innerHTML = tableData;
      //   const deleteButtonsCollection =
      //     document.querySelectorAll(".deleteButton");
      //   const editButtonsCollection = document.querySelectorAll(".editButton");

      //   [...deleteButtonsCollection].forEach((button, index) => {
      //     button.addEventListener("click", () => {
      //       deleteStudent(data[index].id);
      //     });
      //   });
      //   [...editButtonsCollection].forEach((button, index) => {
      //     button.addEventListener("click", () => {
      //       editStudent(data[index].id);
      //     });
      //   });
      // };

      // function hideModal() {
      //   document.querySelector("#formContainer").classList.add("hidden");
      // }

      // function editStudent(id) {
      //   const data = getSingleItemData("students", id);
      //   const formContainer = document.querySelector("#formContainer");
      //   formContainer.classList.remove("hidden");
      //   const form = document.querySelector("form");
      //   form.elements.namedItem("firstName").value = data.firstName;
      //   form.elements.namedItem("lastName").value = data.lastName;
      //   form.elements.namedItem("rollNo").value = data.rollNo;
      //   form.elements.namedItem("phoneNo").value = data.phoneNo;
      //   form.elements.namedItem("email").value = data.email;
      //   form.elements.namedItem("id").value = data.id;
      //   form.elements.namedItem("firstName").focus();
      //   form.addEventListener("submit", editStudentHandler);
      //   const closeModalButton = document.querySelector("#closeModalButton");
      //   const editStudentSubmitButton = document.querySelector(
      //     "#editStudentSubmitButton"
      //   );
      //   const cancelButton = document.querySelector("#cancelButton");
      //   cancelButton.addEventListener("click", hideModal);
      //   closeModalButton.addEventListener("click", hideModal);

      //   // console.log(data);
      // }

      // function deleteStudent(id) {
      //   deleteItemFromStorage("students", id);
      //   document
      //     .querySelector("#deleteNotification")
      //     .classList.remove("hidden");
      //   setTimeout(() => {
      //     location.reload();
      //   }, 600);
      // }

      // function editStudentHandler(e) {
      //   e.preventDefault();
      //   const form = document.querySelector("form");
      //   const id = form.elements.namedItem("id").value;
      //   const firstName = form.elements.namedItem("firstName").value;
      //   const lastName = form.elements.namedItem("lastName").value;
      //   const rollNo = form.elements.namedItem("rollNo").value;
      //   const email = form.elements.namedItem("email").value;
      //   const phoneNo = form.elements.namedItem("phoneNo").value;
      //   const student = {
      //     id,
      //     firstName,
      //     lastName,
      //     rollNo,
      //     email,
      //     phoneNo,
      //   };
      //   editSingleItemData("students", student);
      //   document.querySelector("#formContainer").classList.add("hidden");
      //   document
      //     .querySelector("#editedNotification")
      //     .classList.remove("hidden");
      //   setTimeout(() => {
      //     location.reload();
      //   }, 600);
      // }
    
    console.log('Hello World');
    let students = JSON.parse(window.localStorage.getItem('students'));
    let table = document.getElementById('tableBody');
    
    callthis = () =>{
      const storageData = students.map((value, index) =>{
      return(
        `<tr>
          <td>${index+1}</td>
          <td>${value.firstName}</td>
          <td>${value.lastName}</td>
          <td>${value.rollNo}</td>
          <td>${value.phoneNo}</td>
          <td>${value.email}</td>
          <td><button id="${value.id}" onclick="editFunction(event)">Edit</button></td>
          <td><button id="${value.id}" onclick="deleteFunction(event)">Delete</button></td>
        </tr>`
        );
      }).join('');
      table.innerHTML = storageData;
    }
    callthis();
   
    

    deleteFunction = (ids) =>{
      //let newStorage = JSON.parse(localStorage.getItem('students'));
      console.log(ids.target.id);
      console.log("reached");
      const filteredData = students.filter(filterData);
      console.log(filteredData);

      function filterData(ages){
        return ids.target.id !== ages.id;
      }
      students = filteredData;
      localStorage.setItem('students', JSON.stringify(students));
      console.log(filteredData); // Deleting data of click only
      //Localstorage get data from the last storage object after click change
      callthis();
    }



    editFunction = (ids) =>{
      console.log(ids);
    }
    </script>
  </body>
</html>
